<ion-item *ngIf="!productOrder">
  <ion-thumbnail slot="start">
    <ion-skeleton-text animated></ion-skeleton-text>
  </ion-thumbnail>
  <h6 style="width: 100%">
    <ion-skeleton-text [ngStyle]="{width: randomSkeletonWidth}"></ion-skeleton-text>
  </h6>
</ion-item>

<ion-item lines="none" *ngIf="productOrder" class="ion-hide-lg-down">

  <ion-thumbnail slot="start">
    <img [src]="productOrder.image || '../../assets/defaults/default_logo.png'">
  </ion-thumbnail>

  <ion-row class="inner-item">

    <ion-col sizeLg="3">
      <h6>{{productOrder.name}}</h6>
    </ion-col>

    <ion-col>
      <h6 *ngIf="!edit || !hasPermissionToChangePrice">{{productOrder.priceInOrder || productOrder.price | price}}</h6>
      <ion-input *ngIf="edit && hasPermissionToChangePrice" type="number" step="any" [(ngModel)]="tempPrice" select-text></ion-input>
      <ion-text *ngIf="edit && hasPermissionToChangePrice" class="ion-margin-end">{{null | price}}</ion-text>
    </ion-col>

    <ion-col>
      <h6 *ngIf="!edit">{{productOrder.amount | unitAmount : productOrder.type}}</h6>
      <ion-input *ngIf="edit" type="number" step="any" [(ngModel)]="tempAmount" select-text></ion-input>
      <ion-text *ngIf="edit" class="ion-margin-end">{{null | unitAmount : productOrder.type}}</ion-text>
    </ion-col>

    <ion-col>
      <h6>{{productOrder.amount * (productOrder.priceInOrder || productOrder.price) | price}}</h6>
    </ion-col>

    <ion-col [size]="showComment ? 1 : 2" *ngIf="editProduct">
      <div *ngIf="!edit">
        <ion-button class="small-circle-btn" fill="clear" (click)="clearClicked.emit()" [disabled]="disabled" title="הסרת פריט מהרשימה">
          <ion-icon slot="icon-only" name="close"></ion-icon>
        </ion-button>
        <ion-button fill="clear" (click)="onEditClicked()" [disabled]="disabled" title="עריכת כמות ומחיר עבור הפריט">
          <ion-icon slot="icon-only" src="../../assets/svg/icon_pen.svg"></ion-icon>
        </ion-button>
      </div>
      <div *ngIf="edit">
        <ion-button fill="clear" color="danger" (click)="onCancelChange()" title="ביטול שינוי">
          <ion-icon slot="icon-only" name="close"></ion-icon>
        </ion-button>
        <ion-button fill="clear" color="success" (click)="onAcceptChange()" title="אישור שינוי">
          <ion-icon slot="icon-only" name="checkmark"></ion-icon>
        </ion-button>
      </div>
    </ion-col>

    <ion-col [size]="editBoxes || productOrder.boxes ? 3 : 4" *ngIf="showComment">
      <ion-input id="inputComment" *ngIf="editComment" placeholder="הערות בנוגע למוצר" [(ngModel)]="productOrder.comment" [readonly]="!editComment"></ion-input>
      <p *ngIf="!editComment && productOrder.comment" style="overflow: auto"><ion-text style="text-decoration: underline">הערת לקוח</ion-text>: {{productOrder.comment}}</p>
    </ion-col>

    <ion-col size="1" *ngIf="(editBoxes || productOrder.boxes) && !returnBtn && !productOrder.returnedWeight" title="מספר ארגזים">
      <mat-form-field style="width: 100% !important; text-align: center">
        <input matInput [(ngModel)]="productOrder.boxes" [readonly]="!editBoxes">
        <mat-hint>מס. ארגזים</mat-hint>
      </mat-form-field>
    </ion-col>

    <ion-col *ngIf="returnBtn || productOrder.returnedWeight">
      <ion-button id="extra-btn" color="dark" fill="outline" shape="round" (click)="returnBtnClicked.emit(productOrder)" *ngIf="!productOrder.returnedWeight">החזרת מוצר</ion-button>
      <ion-label color="danger" *ngIf="productOrder.returnedWeight">הוחזרו {{productOrder.returnedWeight | unitAmount : 0}}</ion-label>
    </ion-col>

  </ion-row>

</ion-item>

<ion-item class="ion-hide-lg-up">

  <ion-thumbnail slot="start">
    <img [src]="productOrder.image || '../../assets/defaults/default_logo.png'">
  </ion-thumbnail>

  <ion-label class="ion-hide-sm-down">
    <h2><b><ion-text color="primary">{{productOrder.name}}</ion-text></b></h2>
  </ion-label>

  <ion-label class="ion-hide-sm-down">
    <h6><b>{{productOrder.amount * (productOrder.priceInOrder || productOrder.price) | price}}</b></h6>
  </ion-label>

  <ion-label>
    <h2 class="ion-hide-sm-up"><b><ion-text color="primary">{{productOrder.name}}</ion-text></b></h2>
    <h6 class="ion-hide-sm-up"><b>{{productOrder.amount * (productOrder.priceInOrder || productOrder.price) | price}}</b></h6>
    <p>
      <ion-text>{{productOrder.priceInOrder || productOrder.price | price}}</ion-text>
      <ion-icon name="close" style="vertical-align: middle"></ion-icon>
      <ion-text>{{productOrder.amount | unitAmount : productOrder.type}}</ion-text>
    </p>
  </ion-label>

  <ion-note slot="end" class="ion-float-end"
            *ngIf="productOrder.boxes || editBoxes"
            matTooltip="מספר ארגזים"
            matTooltipPosition="before"
            style="font-size: 1em"
            (click)="popBoxes()"
  >
    <ion-icon name="cube-outline" style="vertical-align: middle" color="primary"></ion-icon>
    <ion-text>{{productOrder.boxes || ''}}</ion-text>
    <ion-text class="ion-hide-xs-down"> ארגזים</ion-text>
  </ion-note>

  <ion-button fill="clear" slot="end" *ngIf="showComment"
              [color]="productOrder.comment ? 'primary' : 'dark'"
              [disabled]="!productOrder.comment && (businessService.side == 's' || !editProduct)"
              (click)="popComment()"
  >
    <ion-icon slot="icon-only" [name]="productOrder.comment ? 'chatbox-ellipses' : 'chatbox-ellipses-outline'"></ion-icon>
  </ion-button>

  <ion-button fill="clear"
              (click)="popEditProduct()"
              *ngIf="editProduct"
              slot="end">
    <ion-icon slot="icon-only" src="../../assets/svg/icon_pen.svg"></ion-icon>
  </ion-button>

  <ion-button class="small-circle-btn" fill="clear"
              (click)="clearClicked.emit()"
              *ngIf="editProduct"
              slot="end">
    <ion-icon slot="icon-only" name="close"></ion-icon>
  </ion-button>

  <ion-button *ngIf="returnBtn && !productOrder.returnedWeight"
              fill="clear" slot="end" shape="round"
              (click)="returnBtnClicked.emit(productOrder)"
              style="width: 10em"
  >החזרה</ion-button>

  <ion-note slot="end" color="danger"
            *ngIf="productOrder.returnedWeight"
            class="ion-no-margin"
            style="font-size: 0.8em; width: 7em"
  >הוחזרו<br>{{productOrder.returnedWeight | unitAmount : 0}}</ion-note>

</ion-item>
